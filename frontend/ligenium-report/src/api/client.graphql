subscription SubscribeOrders {
  order {
    id
    status
    created_at
    updated_at
  }
}

subscription SubscribeOrder($id: Int!) {
  order_by_pk(id: $id) {
    id
    status
    protocols {
      id
      user
      body
      created_at
    }
    incidents {
      incident {
        id
        assumption
        carrier {
          id
        }
      }
    }
    created_at
    updated_at
  }
}

subscription SubscribeCarriers {
  carrier {
    id
    status
    customer
    created_at
    updated_at
  }
}

subscription SubscribeCarrier($id: Int!) {
  carrier_by_pk(id: $id) {
    id
    status
    customer
    created_at
    updated_at
  }
}

subscription SubscribeIncidents {
  incident {
    id
    carrier_id
    assumption
    status
    created_at
    updated_at
  }
}

mutation UpdateCarrier($id: Int!, $status: String!) {
  update_carrier(where: { id: { _eq: $id } }, _set: { status: $status }) {
    affected_rows
  }
}

mutation UpdateIncident($id: Int!, $status: String!) {
  update_incident(where: { id: { _eq: $id } }, _set: { status: $status }) {
    affected_rows
  }
}

mutation CreateOrder($incidents: [order_incidents_insert_input!]!) {
  insert_order_one(object: { incidents: { data: $incidents }, status: "error_detected" }) {
    id
  }
}

mutation CreateProtocol($order: Int!, $body: String!, $user: String!) {
  insert_protocol_one(object: { order_id: $order, body: $body, user: $user }) {
    id
  }
}

mutation UpdateOrder($id: Int!, $status: String!) {
  update_order(where: { id: { _eq: $id } }, _set: { status: $status }) {
    affected_rows
  }
}
